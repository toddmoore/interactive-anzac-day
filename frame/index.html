<!DOCTYPE html>
<html lang="en" class="svg">
	<head>
		<meta charset="utf-8"/>
		<!-- CSS_START -->
		<!--<link rel="stylesheet" href="css/local-fonts.css"/>-->
		<link rel="stylesheet" href="http://pasteup.guim.co.uk/0.0.5/css/fonts.pasteup.min.css"/>
		<link rel="stylesheet" href="css/reset.css"/>
		<link rel="stylesheet" href="css/main.css"/>
		<!-- CSS_END -->
		<!-- JS_START -->
		<script src='js/jquery-1.10.1.min.js' type="text/javascript"></script>
		<script src='js/hand-1.1.2.js' type="text/javascript"></script>
		<script src='js/TweenMax.min.js' type="text/javascript"></script>
		<script src='js/main.js' type="text/javascript"></script>
		<script>
			window.jQuery = window.jQ = jQuery.noConflict();
		</script>
		<title>Image fader</title>
	</head>
	<body>

		<div class="image-fader-controls">
			<div class="gallery-lightbox__btn gallery-lightbox__btn--close js-gallery-close">
				<button class="gallery-lightbox__btn-body"><i></i>close</button>
			</div>
			<div class="gallery-lightbox__progress  gallery-lightbox__progress--sidebar">
				<span class="gallery-lightbox__index js-gallery-index">1</span>
				<span class="gallery-lightbox__progress-separator"></span>
				<span class="gallery-lightbox__count js-gallery-count">6</span>
			</div>
			<b class="next"></b>
			<b class="prev"></b>
		</div>
		<div id="image-fader-container">
			<div class="inner">

			</div>
		</div>
		<div class="image-fader-caption"></div>


		<script src="http://interactive.guim.co.uk/libs/iframe-messenger/iframeMessenger.js" type="text/javascript"></script>

		<script>

		iframeMessenger.enableAutoResize();

		jQ(function() {
		window.currentIndex = 0;

		window.settotals = function(){
			jQ('.js-gallery-count').text(window.totalLength);
		}



		window.el = jQ("#image-fader-container .inner");
		var links = document.querySelectorAll('a');

    		for(var i = 0; i < links.length; i++) {
        		links[i].addEventListener('click', function(event) {
            		event.preventDefault();
            		iframeMessenger.navigate(this.href);
        		}, false);
    	}

		var app = new IMAGE_FADER.App();

		});

		var setCurrentIndex = function(increment){
			jQ('.js-gallery-index').text(currentIndex+increment+1);
			return currentIndex = currentIndex+increment;
		}

		window.loadCurrentIndex = function(){
			jQ('.js-gallery-index').text(currentIndex+1);
			jQ('.inner').addClass("noanimation")
			el.css("transform", "translate3d(-"+currentIndex*100+"vw, 0,0)");
			setTimeout(function(){
				jQ('.inner').removeClass("noanimation");
			}, 1000)
		}

		jQuery(document).on("keydown", function(event){
			if(event.keyCode == 39){
				if(window.currentIndex != (window.totalLength)-1){
					setCurrentIndex(1);
					el.css("transform", "translate3d(-"+currentIndex*100+"vw, 0,0)");
				}
			}
			if(event.keyCode == 37){
				if(window.currentIndex != 0){
					setCurrentIndex(-1);
					el.css("transform", "translate3d(-"+currentIndex*100+"vw, 0,0)");
				}
			}
		});

		jQuery(".next").on("click", function(){
			if(window.currentIndex != (window.totalLength)-1){
				setCurrentIndex(1);
				el.css("transform", "translate3d(-"+currentIndex*100+"vw, 0,0)");
			}
		});

		jQuery(".prev").on("click", function(){
			if(window.currentIndex != 0){
				setCurrentIndex(-1);
				el.css("transform", "translate3d(-"+currentIndex*100+"vw, 0,0)");
			}
		});

		jQuery(".gallery-lightbox__btn--close button").on("click", function(event){
			event.preventDefault();
			iframeMessenger.navigate("#close-interactive");
		});



		</script>
	</body>
</html>
